!function(e){function a(a){e(".rating-info").html(wp_idea_stream_vars.wait_msg);var r={action:"wp_idea_stream_rate",rate:a,wpnonce:wp_idea_stream_vars.wpnonce,idea:e("#rate").data("idea")};e.post(wp_idea_stream_vars.ajaxurl,r,function(a){a&&a>0?e(".rating-info").html(wp_idea_stream_vars.success_msg+" "+a).fadeOut(2e3,function(){t(1),e(this).show()}):(e(".rating-info").html(wp_idea_stream_vars.error_msg),e.fn.raty("readOnly",!1,"#rate"))})}function t(a){var t,r=Number(wp_idea_stream_vars.rate_nb)+a;t=1==r?wp_idea_stream_vars.one_rate:"0"==r?wp_idea_stream_vars.not_rated:wp_idea_stream_vars.x_rate.replace("%",r),e(".rating-info").html("<a>"+t+"</a>")}function r(a,t){e("#group-selected").html('<input type="checkbox" name="_ideastream_group_id" id="_ideastream_group_id" value="'+t.item.value+'" checked><strong class="label"><a href="'+t.item.link+'">'+t.item.label+"</a></strong></input>")}if("undefined"!=typeof wp_idea_stream_vars.raty_loaded&&(t(0),e("div#rate").raty({cancel:!1,half:!1,halfShow:!0,starType:"i",readOnly:wp_idea_stream_vars.readonly,score:wp_idea_stream_vars.average_rate,targetKeep:!1,noRatedMsg:wp_idea_stream_vars.not_rated,hints:wp_idea_stream_vars.hints,number:wp_idea_stream_vars.hints_nb,click:function(t,r){wp_idea_stream_vars.can_rate&&(e.fn.raty("readOnly",!0,"#rate"),a(t))}})),"undefined"!=typeof wp_idea_stream_vars.tagging_loaded&&(e("#_wp_idea_stream_the_tags").tagging({"tags-input-name":"wp_idea_stream[_the_tags]","edit-on-delete":!1,"tag-char":"","forbidden-chars":[".","_","?","<",">"],"forbidden-words":["script"],"no-duplicate-text":wp_idea_stream_vars.duplicate_tag,"forbidden-chars-text":wp_idea_stream_vars.forbidden_chars,"forbidden-words-text":wp_idea_stream_vars.forbidden_words}),e("#_wp_idea_stream_the_title").focus(),e("#wp_idea_stream_most_used_tags .tag-items a").on("click",function(a){a.preventDefault(),e("#_wp_idea_stream_the_tags").tagging("add",e(this).html())}),e("#wp-idea-stream-form").on("reset",function(a){e("#_wp_idea_stream_the_tags").tagging("reset")})),"undefined"!=typeof wp&&"undefined"!=typeof wp.heartbeat&&"undefined"!=typeof wp_idea_stream_vars.pulse&&(wp.heartbeat.interval(wp_idea_stream_vars.pulse),e.fn.extend({"heartbeat-send":function(){return this.bind("heartbeat-send.ideastream")}})),e(document).on("heartbeat-send.ideastream",function(e,a){a.ideastream_heartbeat_current_idea=wp_idea_stream_vars.idea_id}),e(document).on("heartbeat-tick",function(a,t){t.ideastream_heartbeat_response&&(e("#wp-idea-stream .message").length?(e("#wp-idea-stream .message").removeClass("error").addClass("info"),e("#wp-idea-stream .message p").html(wp_idea_stream_vars.warning)):e("#wp-idea-stream").prepend('<div class="message info"><p>'+wp_idea_stream_vars.warning+"</p></div>"),e('#wp-idea-stream .submit input[name="wp_idea_stream[save]"]').remove())}),"undefined"!=typeof wp_idea_stream_vars.is_profile){"undefined"!=typeof wp_idea_stream_vars.profile_editing&&(e("#wp_idea_stream_profile_description").show(),e('textarea[name="wp_idea_stream_profile[description]"]').hide(),e("#wp_idea_stream_profile_form").on("submit",function(a){e('textarea[name="wp_idea_stream_profile[description]"]').val(e("#wp_idea_stream_profile_description").html())}),e('#wp_idea_stream_profile_form input[type="submit"]').before(e(".wp-embed-share").html()),e(".wp-embed-share").remove());var i=e("#item-header-content").innerHeight()||0;e(".wp-embed-share-input").on("click",function(e){e.target.select()}),e(".wp-embed-share-dialog-open").on("click",function(){e("#item-header-content").css({width:"600px",height:"200px"}),e(".wp-embed-share-dialog").removeClass("hidden"),e('.wp-embed-share-tab-button [aria-selected="true"]').focus()}),e(".wp-embed-share-dialog-close").on("click",function(){e(".wp-embed-share-dialog").addClass("hidden"),e(".wp-embed-share-dialog-open").focus(),e("#item-header-content").css({width:"auto",height:i+"px"})}),e(".wp-embed-share-tab-button button").on("click",function(a){var t=e(a.target).attr("aria-controls");e(".wp-embed-share-tab").each(function(a,r){t===e(r).prop("id")?e(r).attr("aria-hidden","false"):e(r).attr("aria-hidden","true")})})}"undefined"!=typeof wp_idea_stream_vars.is_admin&&e("#wp_idea_stream_buddypress_group").autocomplete({source:ajaxurl+"?action=ideastream_search_groups&user_id="+wp_idea_stream_vars.author,delay:500,minLength:2,position:"undefined"!=typeof isRtl&&isRtl?{my:"right top",at:"right bottom",offset:"0, -1"}:{offset:"0, -1"},open:function(){e(this).addClass("open")},close:function(){e(this).removeClass("open"),e(this).val("")},select:function(e,a){r(e,a)}})}(jQuery);
